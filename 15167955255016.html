<!DOCTYPE html>
<html>

<head>
    <title>
         使用 Pipenv 来管理你的 Python 项目 - Hack Notes 
    </title>

    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">

    <link rel="stylesheet" type="text/css" href="asset/yue.css">
    <link rel="stylesheet" type="text/css" href="asset/main.css">
    <link rel="stylesheet" type="text/css" href="asset/tomorrow.css">

    <link rel="alternate" type="application/atom+xml" href="atom.xml" title="Hack Notes">

    <script src="asset/highlight.pack.js"></script>
    <script>hljs.initHighlightingOnLoad();</script>
</head>

<body>
    <header class="yue site-header">
        <div class="wrapper">
            <a class="site-title" href="index.html">Hack Notes</a>
            <nav class="site-nav">
                <a href="#" class="menu-icon">
                    
                    <svg viewBox="0 0 18 15">
                        <path fill="#424242" d="M18,1.484c0,0.82-0.665,1.484-1.484,1.484H1.484C0.665,2.969,0,2.304,0,1.484l0,0C0,0.665,0.665,0,1.484,0 h15.031C17.335,0,18,0.665,18,1.484L18,1.484z"
                        />
                        <path fill="#424242" d="M18,7.516C18,8.335,17.335,9,16.516,9H1.484C0.665,9,0,8.335,0,7.516l0,0c0-0.82,0.665-1.484,1.484-1.484 h15.031C17.335,6.031,18,6.696,18,7.516L18,7.516z"
                        />
                        <path fill="#424242" d="M18,13.516C18,14.335,17.335,15,16.516,15H1.484C0.665,15,0,14.335,0,13.516l0,0 c0-0.82,0.665-1.484,1.484-1.484h15.031C17.335,12.031,18,12.696,18,13.516L18,13.516z"
                        />
                    </svg>

                </a>
                <div class="trigger">
                    
                        <a class="page-link" href="tech.html">TECH</a>
                    
                        <a class="page-link" href="essay.html">ESSAY</a>
                    
                        <a class="page-link" href="life.html">LIFE</a>
                    
                        <a class="page-link" href="photography.html">PHOTOGRAPHY</a>
                    
                        <a class="page-link" href="archives.html">ARCHIVE</a>
                    
                        <a class="page-link" href="atom.xml">RSS</a>
                    
                </div>
            </nav>
        </div>
    </header>
</body>

</html> <script async defer src="//hypothes.is/embed.js"></script>
<div class="page-content yue">
    <div class="wrapper">
        <article class="post" itemscope itemtype="http://schema.org/BlogPosting">
            <header class="post-header">
                <h1 class="post-title" itemprop="name headline">使用 Pipenv 来管理你的 Python 项目</h1>
                <div class="post-description">
                    
                        还在用 virtualenv 吗？
                    
                </div>
                <p class="post-meta">
                    <time class="post-time" datetime="2018-01-24T20:05:25+08:00"itemprop="datePublished">Created by Tisoga at 2018/1/24 20:5 PM</time>
                </p>
            </header>
            <div class="post-content" itemprop="articleBody">
                <h2 id="toc_0">1. 简介</h2>

<p>N 久前，曾经写过一篇文章介绍过 Python 的虚拟环境（<a href="14824097975366.html">virtualenv 相关笔记</a>），不过 virtualenv 使用起来实在是不太友好，所以后来在其基础上又有了 virtualwrapper、pyenv、Pipenv，今天主要介绍一下 Pipenv 这个工具，现在已经成了<a href="https://packaging.python.org/tutorials/managing-dependencies/#managing-dependencies">官方推荐</a>的包管理工具了。</p>

<h3 id="toc_1">1.1 为什么需要虚拟环境</h3>

<p>使用虚拟环境有很多好处：</p>

<ol>
<li>项目之间的包隔离，比如不同的项目之间需要使用不同版本的包；</li>
<li>防止污染系统 Python 环境，因为系统中还是有很多地方需要用到 Python 环境的（macOS 是 2.7），如果你的项目是使用 Python 3+ 的话，可能会带来一些迷之问题；</li>
<li>方便其他开发者来部署开发环境，使用虚拟环境可以方便地导出一份 requirements.txt（或者 Pipfile）来供开发者一键安装所需要的包，而不是运行的是否通过 <code>ImportError</code> 来得知缺少安装了什么包。</li>
</ol>

<p>这里建议为每个 Project 都创建一份虚拟环境。</p>

<h2 id="toc_2">2. 安装</h2>

<p>Pipenv 的安装十分简单：</p>

<pre><code>pip install pipenv
</code></pre>

<p>如果你是 Mac 用户的话，也可以使用 Homebrew 来进行安装：</p>

<pre><code>brew install pipenv
</code></pre>

<h2 id="toc_3">3. 基本使用</h2>

<p>切换到你的 Project，创建一个 Python 3 环境：</p>

<pre><code>$ pipenv --three
Creating a virtualenv for this project…
Using /usr/local/bin/python3 to create virtualenv…
⠋Running virtualenv with interpreter /usr/local/bin/python3
Using base prefix &#39;/Library/Frameworks/Python.framework/Versions/3.7&#39;
/usr/local/Cellar/pipenv/8.3.2/libexec/lib/python2.7/site-packages/virtualenv.py:1039: DeprecationWarning: the imp module is deprecated in favour of importlib; see the module&#39;s documentation for alternative uses
  import imp
New python executable in /Users/jiayuan/.local/share/virtualenvs/demo-0922AcvC/bin/python3
Also creating executable in /Users/jiayuan/.local/share/virtualenvs/demo-0922AcvC/bin/python
Installing setuptools, pip, wheel...done.

Virtualenv location: /Users/jiayuan/.local/share/virtualenvs/demo-0922AcvC
Creating a Pipfile for this project…
</code></pre>

<p>可以看到，它会使用你系统的 Python 3（在我的机器上是 Python 3.7）版本在 <code>/Users/xxx/.local/share/virtualenvs/</code> 目录下为当前的 Project 创建一个虚拟环境。</p>

<p>如果你想使用 Python 2，可以使用 <code>pipenv --two</code> 来创建。</p>

<p>或者你想要自己制定 Python 的版本，可以使用 <code>pipenv --python 3.5</code> 来进行创建。</p>

<p>创建完虚拟环境后，会在目录下面生成一个 Pipfile：</p>

<pre><code>$ cat Pipfile
[[source]]

url = &quot;https://pypi.python.org/simple&quot;
verify_ssl = true
name = &quot;pypi&quot;


[dev-packages]



[packages]



[requires]

python_version = &quot;3.7&quot;
</code></pre>

<p>在虚拟环境中安装包：</p>

<pre><code>$ pipenv install flask
</code></pre>

<p>这会安装 flask 以及相关的依赖包，可以使用 <code>pipenv graph</code> 来查看包的依赖关系：</p>

<pre><code>$ pipenv graph
Flask==0.12.2
  - click [required: &gt;=2.0, installed: 6.7]
  - itsdangerous [required: &gt;=0.21, installed: 0.24]
  - Jinja2 [required: &gt;=2.4, installed: 2.10]
    - MarkupSafe [required: &gt;=0.23, installed: 1.0]
  - Werkzeug [required: &gt;=0.7, installed: 0.14.1]
</code></pre>

<p>然后使用 <code>pipenv shell</code> 进入虚拟环境：</p>

<pre><code>$ pipenv shell
Spawning environment shell (/usr/local/bin/fish). Use &#39;exit&#39; to leave.
</code></pre>

<p>这会创建一个新的 shell 进程，不想使用的时候输入 <code>eixt</code> 就可以退出了。</p>

<p>如果进入了一个新的项目，其中有 <code>requirements.txt</code> 或者 <code>Pipfile</code> 的话，运行 <code>pipenv install</code> 会自动为当前的 Project 创建一个虚拟环境并安装相关依赖。</p>

<h2 id="toc_4">4. 和 fish shell 一起使用</h2>

<p>最近开始把 shell 从 zsh 切换到 fish，发现很多东西都不用配置了，比如想要 cd 进项目的时候就直接激活虚拟环境，只需要在 fish 中安装一个 pipenv 的插件就可以了：<code>fisher pipenv</code>。具体 fish shell 的使用和配置，打算下篇文章详细讲一下。</p>

<p>感觉这篇博客整篇都在灌水……</p>

            </div>
            <div>
                <script type="text/javascript">
    var disqus_shortname = 'tisogasnotes'; 

    (function() {
        var dsq = document.createElement('script'); dsq.type = 'text/javascript'; dsq.async = true;
        dsq.src = '//' + disqus_shortname + '.disqus.com/embed.js';
        (document.getElementsByTagName('head')[0] || document.getElementsByTagName('body')[0]).appendChild(dsq);
    })();
</script>
<script>
var _hmt = _hmt || [];
(function() {
  var hm = document.createElement("script");
  hm.src = "https://hm.baidu.com/hm.js?001e800887eba2f8f57ec8059aafdad6";
  var s = document.getElementsByTagName("script")[0]; 
  s.parentNode.insertBefore(hm, s);
})();
</script>
                
                    <div id="disqus_thread"></div>
                
                
            </div>
        </article>
    </div>
</div>
  <footer id="footer" class="yue">
    <div class="wrapper">
        <p>Designed and Written by <a href="https://twitter.com/Tisoga">Tisoga</a></p>
    </div>
</footer>
<script type="text/javascript" src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.1/MathJax.js?config=TeX-AMS-MML_HTMLorMML"></script><script type="text/x-mathjax-config">MathJax.Hub.Config({TeX: { equationNumbers: { autoNumber: "AMS" } }});</script>
